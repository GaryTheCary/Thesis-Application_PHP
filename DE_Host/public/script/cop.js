(function(){var t,e,n,a,r,o,l,i,u,c,d,s,f,p,h,m,x;d={top:20,right:20,bottom:30,left:30},n=document.getElementById("stack_graph"),x=n.offsetWidth-d.left-d.right,u=n.offsetHeight-d.top-d.bottom,l=Math.floor(x/24),c=2*l,t=6,e=["#ffffd9","#f27521","#6fc382","#f4e12d"],o=["Mo","Tu","We","Th","Fr","Sa","Su"],h=["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12a","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12p"],a="/assets/data/data2.tsv",f=d3.select("#stack_graph").append("svg").attr("width",x+d.left+d.right).attr("height",u+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")"),r=f.selectAll(".dayLayer").data(o).enter().append("text").text(function(t){return t}).attr("x",0).attr("y",function(t,e){return e*l}).style("text-anchor","end").attr("transform","translate(-10,"+l/1.5+")").attr("class",function(t,e){return e>=0&&4>=e?"dayLabel mono axis axis-workweek":"dayLabel mono axis"}),p=f.selectAll(".timeLabel").data(h).enter().append("text").text(function(t){return t}).attr("x",function(t,e){return e*l}).attr("y",0).style("text-anchor","middle").attr("transform","translate("+l/2+", -6)").attr("class",function(t,e){return e>=7&&16>=e?"timeLabel mono axis axis-worktime":"timeLabel mono axis"}),i=function(n){return d3.tsv(n,function(t){return console.log(t.zone),{day:+t.day,hour:+t.hour,zone:+t.zone}},function(n,a){var r,o,i,d;if(n)throw n;return o=d3.scale.quantile().domain([0,t-1,d3.max(a,function(t){return t.zone})]).range(e),r=f.selectAll(".hour").data(a,function(t){return t.day+":"+t.hour}),r.append("title"),r.enter().append("rect").attr("x",function(t){return(t.hour-1)*l}).attr("y",function(t){return(t.day-1)*l}).attr("rx",1).attr("ry",1).attr("class","hour bordered").attr("width",l).attr("height",l).style("fill",e[0]),r.transition().duration(1e3).style("fill",function(t){return o(t.zone)}),r.select("title").text(function(t){return t.zone}),r.exit().remove(),i=f.selectAll(".legend").data([0].concat(o.quantiles()),function(t){return t}),i.enter().append("g").attr("class","legend"),d=70,i.append("rect").attr("x",function(t,e){return c*e}).attr("y",u-d).attr("width",c).attr("height",l/2).style("fill",function(t,n){return e[n]}),i.append("text").attr("class","mono").text(function(t){return"â‰¥ "+Math.round(t)}).attr("x",function(t,e){return c*e}).attr("y",u-d+l),i.exit().remove()})},i(a),m=document.getElementById("BTNUpdate"),m.onclick=function(){return document.location.reload(!0)},s=document.getElementById("normal"),s.checked=!0,document.getElementById("Expectation").disabled=!0}).call(this);